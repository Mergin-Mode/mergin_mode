(this.webpackJsonp3drw=this.webpackJsonp3drw||[]).push([[0],{193:function(e,t,n){e.exports=n(440)},198:function(e,t,n){},200:function(e,t,n){},213:function(e,t,n){},417:function(e,t,n){},440:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(21),c=n.n(o),i=(n(198),n(199),n(79)),l=n(180),s=n(23),d=(n(200),n(29)),u=n(441),m=n(442),p=n(443),h=n(444),f=n(445),E=n(451),b=n(450),v=n(452),w=n(446),g=n(447),y=n(448),O=n(449),S=n(2),k=n(182),j=n(122);function N(e,t,n,a,r,o,c,i){c.FBXLoader=j.a;new S.g;var l=new S.N,s=new S.Z;(n=new S.P).background=new S.h(0),(a=new S.eb({antialias:!0})).setPixelRatio(window.devicePixelRatio),a.setSize(window.innerWidth,window.innerHeight),a.shadowMap.enabled=!0,document.getElementById("three-map").appendChild(a.domElement),(e=new S.H(60,window.innerWidth/window.innerHeight,1,1e4)).position.set(80,80,80),e.up.set(0,0,1),(t=new k.a(e,a.domElement)).enableDamping=!0,t.dampingFactor=.05,t.screenSpacePanning=!1,t.minDistance=10,t.maxDistance=1e3,t.maxPolarAngle=Math.PI/2,function(e){for(var t=e.getAttribute("position"),n=t.array,a=e.parameters.width,r=e.parameters.height,o=0;o<a;o++)for(var c=0;c<r;c++)n[3*(o*r+c)+2]=0;t.needsUpdate=!0,e.computeVertexNormals()}(p=new S.I(1e3,1e3,100,100)),(h=new S.D({color:"#222",side:S.l})).flatShading=!0;var d=new S.A(p,h);d.position.set(0,0,0),d.castShadow=!0,d.receiveShadow=!0,n.add(d),(m=new S.j(16777215)).position.set(1,1,100),m.shadow={camera:{near:.5,far:300,left:-50,bottom:-50,right:50,top:50},bias:1e-4,mapSize:{x:6144,y:6144}},n.add(m);var u=new S.k(m,5);n.add(u),(m=new S.j(8840)).position.set(-0,-0,-100),n.add(m);u=new S.k(m,5);n.add(u);var m=new S.a(6710886);n.add(m);var p=new S.S(1,32,32),h=new S.B({color:16711680});return r=new S.A(p,h),n.add(r),function r(){requestAnimationFrame(r),t.update(),a.render(n,e)}(),window.addEventListener("resize",(function(){e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),a.setSize(window.innerWidth,window.innerHeight)}),!1),window.addEventListener("mousedown",(function(t){var n=document.getElementById("three-map").getBoundingClientRect(),a=n.left,o=n.top;s.x=(t.clientX-a)/window.innerWidth*2-1,s.y=-(t.clientY-o)/window.innerHeight*2+1,l.setFromCamera(s,e);var c=l.intersectObject(d);c.length>0&&(r.position.set(0,0,0),r.lookAt(c[0].face.normal),r.position.copy(c[0].point))}),!1),{camera:e,controls:t,scene:n,renderer:a,pointer:r,partials:{plane:d,pointer:r},loaders:c}}j.a.prototype.load2=function(e,t){var n=this,a=e[0],r=new FileReader;r.onload=function(e){if(2===e.target.readyState||0===e.target.status){var a=n.parse(e.target.result||e.target.responseText);t&&t(a)}},r.readAsArrayBuffer(a)};var x=n(75),C=n(76),z=n.n(C),_=n(38),D=n(77),A=n(40),M=n(39),L=n(41),I=(n(212),n(213),n(191)),B=n(116),P=function(e){function t(e){var n;Object(_.a)(this,t),n=Object(A.a)(this,Object(M.a)(t).call(this,e));e.keys;return n.state={clicked:!1,color:"#000"},n}return Object(L.a)(t,e),Object(D.a)(t,[{key:"render",value:function(){return this.state.clicked?r.a.createElement(B.SketchPicker,null):r.a.createElement("div",{style:{backgroundColof:this.state.color,border:"3px solid whitesmoke",borderRadius:"4px",width:"16px",height:"16px",float:"right"}})}}]),t}(r.a.Component);P.defaultProps={};var T=function(e){return{type:"LOAD_MODEL",model:e,id:Date.now()}},R=function(e){return{type:"CHANGE_SECTION",section:e}},K=[{key:"0",title:"Models",checkable:!1,selectable:!0,children:[]},{key:"1",title:"Scene",checkable:!1,selectable:!1,children:[{key:"1-0",title:"Background",checkable:!1,selectable:!1,children:[{key:"1-0-0",title:"Color"},{key:"1-0-1",title:"Image"},{key:"1-0-2",title:"Video"}]},{key:"1-1",title:"Ground",checkable:!1,selectable:!1,children:[{key:"1-1-0",title:"Color"},{key:"1-1-1",title:"Image"},{key:"1-1-2",title:"Vertices"}]}]}],H=function(e){function t(e){var n;Object(_.a)(this,t),(n=Object(A.a)(this,Object(M.a)(t).call(this,e))).onExpand=function(e){console.log("onExpand",e)},n.onSelect=function(e,t){var a=t.node.title.toLowerCase();console.log("selected",e,t),n.selKey=t.node.props.eventKey,n.props.changeSection(e.length?a:null)},n.onCheck=function(e,t){console.log(n.props),console.log("onCheck",e,t)},n.onEdit=function(){setTimeout((function(){console.log("current key: ",n.selKey)}),0)},n.onDel=function(e){window.confirm("sure to delete?")&&e.stopPropagation()},n.setTreeRef=function(e){n.tree=e};var a=e.keys;return n.state={defaultExpandedKeys:a,defaultSelectedKeys:[],defaultCheckedKeys:a},n.treeRef=r.a.createRef(),n}return Object(L.a)(t,e),Object(D.a)(t,[{key:"render",value:function(){r.a.createElement("span",{className:"cus-label"},r.a.createElement("span",null,"operations: "),r.a.createElement("span",{style:{color:"blue"},onClick:this.onEdit},"Edit"),"\xa0",r.a.createElement("label",{onClick:function(e){return e.stopPropagation()}},r.a.createElement("input",{type:"checkbox"})," checked"),"\xa0",r.a.createElement("span",{style:{color:"#EB0000"},onClick:this.onDel},"Delete"));return r.a.createElement("div",{style:{margin:"0 20px"}},r.a.createElement(I.a,{className:"myCls",showLine:!0,checkable:!0,multiple:!1,checkStrictly:!0,selectable:!0,defaultExpandAll:!0,onExpand:this.onExpand,defaultSelectedKeys:this.state.defaultSelectedKeys,defaultCheckedKeys:this.state.defaultCheckedKeys,onSelect:this.onSelect,onCheck:this.onCheck,treeData:K}))}}]),t}(r.a.Component);H.defaultProps={keys:["0-0-0-0"]};var F=Object(d.b)((function(e){return{}}),(function(e){return{changeSection:function(t){return e(R(t))}}}))(H);n(417);var J=Object(d.b)((function(e){return{models:e.api.models,title:e.api.section.title,scene:e.api.scene}}),(function(e){return{loadModel:function(t){return e(T(t))},changeSection:function(t){return e(R(t))}}}))((function(e){var t=Object(a.useState)(JSON.stringify({x:0,y:0,z:0})),n=Object(s.a)(t,2),o=n[0],c=n[1],i=Object(a.useState)(JSON.stringify({x:1,y:1,z:1})),l=Object(s.a)(i,2),d=l[0],u=l[1],m=Object(a.useState)(JSON.stringify({x:0,y:0,z:0})),p=Object(s.a)(m,2),h=p[0],f=p[1],E=function(e,t){return e(t)};return r.a.createElement("div",{className:"ModelList"},r.a.createElement("h3",null,e.title),r.a.createElement("input",{value:o,onChange:function(e){return E(c,e.target.value)}}),r.a.createElement("input",{value:h,onChange:function(e){return E(f,e.target.value)}}),r.a.createElement("input",{value:d,onChange:function(e){return E(u,e.target.value)}}),e.models.data.map((function(t){return r.a.createElement("div",{className:"model-item col-md-3 col-sm-6 col-xs-12"},r.a.createElement("div",null,"id: ",t.id),r.a.createElement("div",null,"name: ",t.name),r.a.createElement("div",null,"size: ",(t.size/1e3/1e3).toFixed(2)," Mb"),r.a.createElement("button",{onClick:function(){var n=t.mesh.clone(),a=JSON.parse(o);a.x=Number(a.x),a.y=Number(a.y),a.z=Number(a.z);var r=JSON.parse(h);r.x=Number(r.x),r.y=Number(r.y),r.z=Number(r.z);var c=JSON.parse(d);c.x=Number(c.x),c.y=Number(c.y),c.z=Number(c.z),n.rotation.set(r.x,r.y,r.z),n.scale.set(c.x,c.y,c.z),n.position.set(a.x,a.y,a.z),n.castShadow=!0,n.receiveShadow=!0,e.scene.add(n)}},"Add To Scene"))})))}));z.a.setAppElement("#root");var W=Object(d.b)((function(e){return{section:e.api.section.active,title:e.api.section.title}}),(function(e){return{loadModel:function(t){return e(T(t))},changeSection:function(t){return e(R(t))},setScene:function(t){return e(function(e){return{type:"SET_SCENE",scene:e,id:Date.now()}}(t))}}}))((function(e){var t=Object(a.useState)(!1),n=Object(s.a)(t,2),o=n[0],c=n[1],d=Object(a.useState)(!1),S=Object(s.a)(d,2),k=S[0],j=S[1],C=Object(a.useState)([]),_=Object(s.a)(C,2),D=_[0],A=_[1],M=Object(a.useState)({camera:{},controls:{},scene:{},renderer:{},pointer:{},partials:{},loaders:{}}),L=Object(s.a)(M,2),I=L[0],B=L[1],P=function(){return j(!k)};return Object(a.useEffect)((function(){var t=I.camera,n=I.controls,a=I.scene,r=I.renderer,o=I.pointer,c=(I.partials,I.loaders),i=(document.getElementById("three-map"),N(t,n,a,r,o,0,c));e.setScene(i.scene),B(Object(l.a)({},i))}),[]),r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(u.a,{expand:"md",className:"navbar navbar-dark"},r.a.createElement(m.a,{href:"/"},r.a.createElement("div",{className:"logo-container"},r.a.createElement("div",{className:"logo"}),"Mergin' Mode")),r.a.createElement(p.a,{onClick:function(){return c(!o)}}),r.a.createElement(h.a,{isOpen:o,navbar:!0},r.a.createElement(f.a,{className:"mr-auto",navbar:!0},r.a.createElement(E.a,{nav:!0,inNavbar:!0},r.a.createElement(b.a,{nav:!0,caret:!0},"File"),r.a.createElement(v.a,{right:!0},r.a.createElement(w.a,{onClick:P},r.a.createElement("span",null,"Import ")),r.a.createElement(w.a,null,"Open"),r.a.createElement(w.a,{divider:!0}))),r.a.createElement(g.a,null,r.a.createElement(y.a,{href:"https://github.com/prieston/mergin_mode"},"GitHub"))),r.a.createElement(O.a,null,"Mergin' Mode")))),r.a.createElement("main",null,r.a.createElement(x.a,{split:"horizontal",minSize:50,maxSize:-50,defaultSize:"80%"},r.a.createElement("div",null,r.a.createElement(x.a,{split:"vertical",minSize:50,maxSize:-50,defaultSize:"20%"},r.a.createElement("div",null,r.a.createElement(F,null)),r.a.createElement("div",{id:"three-map"}))),r.a.createElement("div",null,null!==e.section&&("models"===e.section?r.a.createElement(J,null):r.a.createElement("span",null))))),r.a.createElement(z.a,{isOpen:k,onRequestClose:function(){return j(!k)}},r.a.createElement("div",{className:"container form"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("input",{className:"form-control",type:"file",onChange:function(e){A(Object(i.a)(e.target.files))}}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("button",{className:"btn btn-primary form-control",onClick:function(){return function(t){var n=t[0],a=n.name,r=n.size;I.scene;(new I.loaders.FBXLoader).load2(t,(function(n){console.log(t),n.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})),e.loadModel({name:a,size:r,object:n}),j(!k)}))}(D)}},"Load")),r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("button",{className:"btn btn-secondary form-control",onClick:P},"Close"))))))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var X=n(37),V=n(189),G=n(190),U={scene:{},models:{data:[]},section:{active:null,title:null}},q={models:"Models"},Y=Object(X.c)({api:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_MODEL":return Object.assign({},e,Object.assign({},e.models,{models:{data:[].concat(Object(i.a)(e.models.data),[{id:[t.id],mesh:t.model.object,name:t.model.name,size:t.model.size}])}}));case"CHANGE_SECTION":return Object.assign({},e,Object.assign({},e.section,{section:{active:t.section,title:q[t.section]||null}}));case"SET_SCENE":return Object.assign({},e,Object.assign({},e.scene,{scene:t.scene}));default:return e}}}),Z=document.getElementById("root"),$=Object(V.createLogger)({}),Q=Object(X.d)(Y,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),Object(X.a)(G.a,$));c.a.render(r.a.createElement(d.a,{store:Q},r.a.createElement(W,null)),Z),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[193,1,2]]]);
//# sourceMappingURL=main.c44cac4e.chunk.js.map
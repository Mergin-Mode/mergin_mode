(this.webpackJsonp3drw=this.webpackJsonp3drw||[]).push([[0],{193:function(e,t,n){e.exports=n(440)},198:function(e,t,n){},200:function(e,t,n){},213:function(e,t,n){},417:function(e,t,n){},440:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),r=n(21),i=n.n(r),c=(n(198),n(199),n(79)),l=n(180),s=n(57),d=(n(200),n(28)),m=n(441),u=n(442),p=n(443),h=n(444),f=n(445),E=n(451),b=n(450),w=n(452),v=n(446),g=n(447),k=n(448),y=n(449),O=n(2),S=n(182),j=n(122);function C(e,t,n,a,o,r,i,c){i.FBXLoader=j.a;new O.g;var l=new O.N,s=new O.Z;(n=new O.P).background=new O.h(0),(a=new O.eb({antialias:!0})).setPixelRatio(window.devicePixelRatio),a.setSize(window.innerWidth,window.innerHeight),a.shadowMap.enabled=!0,document.getElementById("three-map").appendChild(a.domElement),(e=new O.H(60,window.innerWidth/window.innerHeight,1,1e3)).position.set(20,20,20),e.up.set(0,0,1),(t=new S.a(e,a.domElement)).enableDamping=!0,t.dampingFactor=.05,t.screenSpacePanning=!1,t.minDistance=10,t.maxDistance=500,t.maxPolarAngle=Math.PI/2,function(e){for(var t=e.getAttribute("position"),n=t.array,a=e.parameters.width,o=e.parameters.height,r=0;r<a;r++)for(var i=0;i<o;i++)n[3*(r*o+i)+2]=0;t.needsUpdate=!0,e.computeVertexNormals()}(p=new O.I(1e3,1e3,100,100)),(h=new O.D({color:16776960,side:O.l})).flatShading=!0;var d=new O.A(p,h);d.position.set(0,0,0),d.castShadow=!0,d.receiveShadow=!0,n.add(d),(u=new O.j(16777215)).position.set(1,1,100),u.shadow={camera:{near:.5,far:300,left:-50,bottom:-50,right:50,top:50},bias:1e-4,mapSize:{x:6144,y:6144}},n.add(u);var m=new O.k(u,5);n.add(m),(u=new O.j(8840)).position.set(-0,-0,-100),n.add(u);m=new O.k(u,5);n.add(m);var u=new O.a(6710886);n.add(u);var p=new O.S(1,32,32),h=new O.B({color:16711680});return o=new O.A(p,h),n.add(o),function o(){requestAnimationFrame(o),t.update(),a.render(n,e)}(),window.addEventListener("resize",(function(){e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),a.setSize(window.innerWidth,window.innerHeight)}),!1),window.addEventListener("mousedown",(function(t){var n=document.getElementById("three-map").getBoundingClientRect(),a=n.left,r=n.top;s.x=(t.clientX-a)/window.innerWidth*2-1,s.y=-(t.clientY-r)/window.innerHeight*2+1,l.setFromCamera(s,e);var i=l.intersectObject(d);i.length>0&&(o.position.set(0,0,0),o.lookAt(i[0].face.normal),o.position.copy(i[0].point))}),!1),{camera:e,controls:t,scene:n,renderer:a,pointer:o,partials:{plane:d,pointer:o},loaders:i}}j.a.prototype.load2=function(e,t){var n=this,a=e[0],o=new FileReader;o.onload=function(e){if(2===e.target.readyState||0===e.target.status){var a=n.parse(e.target.result||e.target.responseText);t&&t(a)}},o.readAsArrayBuffer(a)};var N=n(75),x=n(76),z=n.n(x),D=n(37),M=n(77),_=n(39),A=n(38),L=n(40),I=(n(212),n(213),n(191)),B=n(116),P=function(e){function t(e){var n;Object(D.a)(this,t),n=Object(_.a)(this,Object(A.a)(t).call(this,e));e.keys;return n.state={clicked:!1,color:"#000"},n}return Object(L.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){return this.state.clicked?o.a.createElement(B.SketchPicker,null):o.a.createElement("div",{style:{backgroundColof:this.state.color,border:"3px solid whitesmoke",borderRadius:"4px",width:"16px",height:"16px",float:"right"}})}}]),t}(o.a.Component);P.defaultProps={};var R=function(e){return{type:"LOAD_MODEL",model:e,id:Date.now()}},K=function(e){return{type:"CHANGE_SECTION",section:e}},H=[{key:"0",title:"Models",checkable:!1,selectable:!0,children:[]},{key:"1",title:"Scene",checkable:!1,selectable:!1,children:[{key:"1-0",title:"Background",checkable:!1,selectable:!1,children:[{key:"1-0-0",title:"Color"},{key:"1-0-1",title:"Image"},{key:"1-0-2",title:"Video"}]},{key:"1-1",title:"Ground",checkable:!1,selectable:!1,children:[{key:"1-1-0",title:"Color"},{key:"1-1-1",title:"Image"},{key:"1-1-2",title:"Vertices"}]}]}],T=function(e){function t(e){var n;Object(D.a)(this,t),(n=Object(_.a)(this,Object(A.a)(t).call(this,e))).onExpand=function(e){console.log("onExpand",e)},n.onSelect=function(e,t){var a=t.node.title.toLowerCase();console.log("selected",e,t),n.selKey=t.node.props.eventKey,n.props.changeSection(e.length?a:null)},n.onCheck=function(e,t){console.log(n.props),console.log("onCheck",e,t)},n.onEdit=function(){setTimeout((function(){console.log("current key: ",n.selKey)}),0)},n.onDel=function(e){window.confirm("sure to delete?")&&e.stopPropagation()},n.setTreeRef=function(e){n.tree=e};var a=e.keys;return n.state={defaultExpandedKeys:a,defaultSelectedKeys:[],defaultCheckedKeys:a},n.treeRef=o.a.createRef(),n}return Object(L.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){o.a.createElement("span",{className:"cus-label"},o.a.createElement("span",null,"operations: "),o.a.createElement("span",{style:{color:"blue"},onClick:this.onEdit},"Edit"),"\xa0",o.a.createElement("label",{onClick:function(e){return e.stopPropagation()}},o.a.createElement("input",{type:"checkbox"})," checked"),"\xa0",o.a.createElement("span",{style:{color:"#EB0000"},onClick:this.onDel},"Delete"));return o.a.createElement("div",{style:{margin:"0 20px"}},o.a.createElement(I.a,{className:"myCls",showLine:!0,checkable:!0,multiple:!1,checkStrictly:!0,selectable:!0,defaultExpandAll:!0,onExpand:this.onExpand,defaultSelectedKeys:this.state.defaultSelectedKeys,defaultCheckedKeys:this.state.defaultCheckedKeys,onSelect:this.onSelect,onCheck:this.onCheck,treeData:H}))}}]),t}(o.a.Component);T.defaultProps={keys:["0-0-0-0"]};var F=Object(d.b)((function(e){return{}}),(function(e){return{changeSection:function(t){return e(K(t))}}}))(T);n(417);var W=Object(d.b)((function(e){return{models:e.api.models,title:e.api.section.title}}),(function(e){return{loadModel:function(t){return e(R(t))},changeSection:function(t){return e(K(t))}}}))((function(e){return o.a.createElement("div",{className:"ModelList"},o.a.createElement("h3",null,e.title),e.models.data.map((function(e){return o.a.createElement("div",{className:"model-item col-md-3 col-sm-6 col-xs-12"},o.a.createElement("div",null,"id: ",e.id),o.a.createElement("div",null,"name: ",e.name),o.a.createElement("div",null,"size: ",(e.size/1e3/1e3).toFixed(2)," Mb"))})))}));z.a.setAppElement("#root");var X=Object(d.b)((function(e){return{section:e.api.section.active,title:e.api.section.title}}),(function(e){return{loadModel:function(t){return e(R(t))},changeSection:function(t){return e(K(t))}}}))((function(e){var t=Object(a.useState)(!1),n=Object(s.a)(t,2),r=n[0],i=n[1],d=Object(a.useState)(!1),O=Object(s.a)(d,2),S=O[0],j=O[1],x=Object(a.useState)([]),D=Object(s.a)(x,2),M=D[0],_=D[1],A=Object(a.useState)({camera:{},controls:{},scene:{},renderer:{},pointer:{},partials:{},loaders:{}}),L=Object(s.a)(A,2),I=L[0],B=L[1],P=function(){return j(!S)};return Object(a.useEffect)((function(){var e=I.camera,t=I.controls,n=I.scene,a=I.renderer,o=I.pointer,r=(I.partials,I.loaders),i=(document.getElementById("three-map"),C(e,t,n,a,o,0,r));B(Object(l.a)({},i))}),[]),o.a.createElement("div",{className:"App"},o.a.createElement("header",{className:"App-header"},o.a.createElement(m.a,{expand:"md",className:"navbar navbar-dark"},o.a.createElement(u.a,{href:"/"},o.a.createElement("div",{className:"logo-container"},o.a.createElement("div",{className:"logo"}),"Mergin' Mode")),o.a.createElement(p.a,{onClick:function(){return i(!r)}}),o.a.createElement(h.a,{isOpen:r,navbar:!0},o.a.createElement(f.a,{className:"mr-auto",navbar:!0},o.a.createElement(E.a,{nav:!0,inNavbar:!0},o.a.createElement(b.a,{nav:!0,caret:!0},"File"),o.a.createElement(w.a,{right:!0},o.a.createElement(v.a,{onClick:P},o.a.createElement("span",null,"Import ")),o.a.createElement(v.a,null,"Open"),o.a.createElement(v.a,{divider:!0}))),o.a.createElement(g.a,null,o.a.createElement(k.a,{href:"https://github.com/prieston/mergin_mode"},"GitHub"))),o.a.createElement(y.a,null,"Mergin' Mode")))),o.a.createElement("main",null,o.a.createElement(N.a,{split:"horizontal",minSize:50,maxSize:-50,defaultSize:"80%"},o.a.createElement("div",null,o.a.createElement(N.a,{split:"vertical",minSize:50,maxSize:-50,defaultSize:"20%"},o.a.createElement("div",null,o.a.createElement(F,null)),o.a.createElement("div",{id:"three-map"}))),o.a.createElement("div",null,null!==e.section&&("models"===e.section?o.a.createElement(W,null):o.a.createElement("span",null))))),o.a.createElement(z.a,{isOpen:S,onRequestClose:function(){return j(!S)}},o.a.createElement("div",{className:"container form"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-12"},o.a.createElement("input",{className:"form-control",type:"file",onChange:function(e){_(Object(c.a)(e.target.files))}}))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-6"},o.a.createElement("button",{className:"btn btn-primary form-control",onClick:function(){return function(t){var n=t[0],a=n.name,o=n.size;I.scene;(new I.loaders.FBXLoader).load2(t,(function(n){console.log(t),n.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})),e.loadModel({name:a,size:o,object:n}),j(!S)}))}(M)}},"Load")),o.a.createElement("div",{className:"col-sm-6"},o.a.createElement("button",{className:"btn btn-secondary form-control",onClick:P},"Close"))))))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var V=n(36),G=n(189),U=n(190),q={models:{data:[]},section:{active:null,title:null}},J={models:"Models"},Y=Object(V.c)({api:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_MODEL":return Object.assign({},e,Object.assign({},e.models,{models:{data:[].concat(Object(c.a)(e.models.data),[{id:[t.id],mesh:t.model.object,name:t.model.name,size:t.model.size}])}}));case"CHANGE_SECTION":return Object.assign({},e,Object.assign({},e.section,{section:{active:t.section,title:J[t.section]||null}}));default:return e}}}),Z=document.getElementById("root"),$=Object(G.createLogger)({}),Q=Object(V.d)(Y,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),Object(V.a)(U.a,$));i.a.render(o.a.createElement(d.a,{store:Q},o.a.createElement(X,null)),Z),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[193,1,2]]]);
//# sourceMappingURL=main.03b15b5f.chunk.js.map
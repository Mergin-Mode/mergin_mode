(this.webpackJsonp3drw=this.webpackJsonp3drw||[]).push([[0],{180:function(e,t){},208:function(e,t,a){e.exports=a(466)},213:function(e,t,a){},215:function(e,t,a){},229:function(e,t,a){},436:function(e,t){},437:function(e,t){},438:function(e,t,a){},466:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(23),i=a.n(o),c=(a(213),a(214),a(20)),l=a(16),s=a(13),d=(a(215),a(15)),m=a(1),u=a(206);var p=function(e){var t=Object(n.useCallback)((function(e){}),[]),a=Object(u.a)({onDrop:t}),o=a.getRootProps,i=a.getInputProps,c=a.isDragActive,l=Object(n.useState)(""),d=Object(s.a)(l,2),m=d[0],p=d[1];return r.a.createElement("div",Object.assign({className:"mm-dropzone"},o()),r.a.createElement("input",Object.assign({},i(),{onChange:function(t){console.log(t.target.files),p(Array.prototype.slice.call(t.target.files).map((function(e){return e.name})).join(", ")||""),e.onChange(t)}})),c?r.a.createElement("p",null,"Drop the files here ..."):r.a.createElement("p",null,"Drag 'n' drop some files here, or click to select files"),r.a.createElement("p",null,r.a.createElement("a",{href:"#"},m)))},f=function(e,t,a,n){return{Xb:e+a*Math.sin(n/63.6619772367581),Yb:t+a*Math.cos(n/63.6619772367581)}},b=function(e,t,a,n){var r=Math.abs(a-e),o=Math.abs(n-t),i=Math.sqrt(Math.pow(r,2)+Math.pow(o,2));return Number(i.toFixed(4))},g=function(e,t,a,n){var r=Math.abs(a-e),o=Math.abs(n-t),i=Math.sqrt(Math.pow(r,2)+Math.pow(o,2)),c=a-e,l=n-t,s=63.6619772367581*Math.atan(r/o);if(c>0&&l>0)var d=s;if(c>0&&l<0)d=200-s;if(c<0&&l<0)d=200+s;if(c<0&&l>0)d=400-s;if(0==c&&l>0)d=0;if(0==c&&l<0)d=200;if(c>0&&0==l)d=100;if(c<0&&0==l)d=300;if(0==c&&0==l)d=0;return{Gab:d.toFixed(4),Sab:i.toFixed(4)}},h=a(468),y=a(469),v=a(470),E=a(471),w=a(472),O=a(477),k=a(476),N=a(478),S=a(473),j=a(474),M=a(475),x=(a(220),a(120)),C=a(127),L=a(121),_=function(e,t,a){if(0==a.length)return 0;var n=(b(0,e,0,-50)/(100/99)).toFixed(4)-0,r=(b(0,t,0,50)/(100/99)).toFixed(4)-0,o=Math.floor(n),i=Math.floor(r),c=n-o,l=r-i;if(0==c&&0==l){var s=100*i+o;return Number(a[s][2].toFixed(4))}if(c<=1-l){if(!a[s=100*i+o]||!a[s+1])return 0;var d=a[s][2]-a[s+1][2],m=Math.sqrt(Math.pow(d/150-0,2)+Math.pow(100/99,2)),u=c+l,p=Math.sqrt(Math.pow(l*(100/99),2)+Math.pow(l*(100/99),2)),f=m*u,g=Math.atan(Math.abs((d/150-0)/(100/99))),h=f*Math.sin(g);if(d<0)var y=a[s][2]/150-0+h;else y=a[s][2]/150-0-h;if(!a[s]||!a[s+100])return 0;var v=a[s][2]-a[s+100][2],E=Math.sqrt(Math.pow(v/150-0,2)+Math.pow(100/99,2)),w=l+c,O=Math.sqrt(Math.pow(c*(100/99),2)+Math.pow(c*(100/99),2)),k=E*w,N=Math.atan(Math.abs((v/150-0)/(100/99))),S=k*Math.sin(N);if(v<0)var j=a[s][2]/150-0+S;else j=a[s][2]/150-0-S;var M=p/(O+p),x=Math.abs(y-j)*M;if(y-j<0)var C=y+x;else C=y-x}else{if(!a[s=100*(i+1)+o+1]||!a[s-1])return 0;d=a[s][2]-a[s-1][2],m=Math.sqrt(Math.pow(d/150-0,2)+Math.pow(100/99,2)),u=1-c+(1-l),p=Math.sqrt(Math.pow(100/99*(1-l),2)+Math.pow(100/99*(1-l),2)),f=m*u,g=Math.atan(Math.abs((d/150-0)/(100/99))),h=f*Math.sin(g);if(d<0)y=a[s][2]/150-0+h;else y=a[s][2]/150-0-h;if(!a[s]||!a[s-100])return 0;v=a[s][2]-a[s-100][2],E=Math.sqrt(Math.pow(v/150-0,2)+Math.pow(100/99,2)),w=1-l+(1-c),O=Math.sqrt(Math.pow(100/99*(1-c),2)+Math.pow(100/99*(1-c),2)),k=E*w,N=Math.atan(Math.abs((v/150-0)/(100/99))),S=k*Math.sin(N);if(v<0)j=a[s][2]/150-0+S;else j=a[s][2]/150-0-S;M=p/(O+p),x=Math.abs(y-j)*M;if(y-j<0)C=y+x;else C=y-x}return Number(C.toFixed(4))};function z(e,t,a,n,r,o,i,c,l,s){i.FBXLoader=C.a,i.GLTFLoader=L.a;var d=new m.k,u=new m.mb,p=new m.Fb,g=document.getElementById("three-map"),h=document.getElementById("axes-helper");a=new m.ob;var y=new m.ob;a.background=new m.l(0),(n=new m.Kb({antialias:!0,alpha:!0})).setPixelRatio(window.devicePixelRatio),n.setClearColor(0,0),n.setSize(g.clientWidth,g.clientHeight);var v=new m.Kb({antialias:!0,alpha:!0});v.setPixelRatio(window.devicePixelRatio),v.setClearColor(0,0),v.setSize(h.clientWidth,h.clientHeight),g.appendChild(n.domElement),h.appendChild(v.domElement),(e=new m.cb(60,g.clientWidth/g.clientHeight,1,1e4)).position.set(80,80,80),e.up.set(0,0,1),(t=new x.a(e,n.domElement)).enableDamping=!0,t.dampingFactor=.05,t.screenSpacePanning=!1,t.minDistance=1,t.maxDistance=1e3,t.maxPolarAngle=Math.PI/2;var E=new m.cb(60,h.clientWidth/h.clientHeight,1,1e4);E.position.set(6,6,6),E.lookAt(y.position);var w=new x.a(E,n.domElement);w.enableDamping=!0,w.dampingFactor=.05,w.screenSpacePanning=!1,w.maxPolarAngle=Math.PI/2,w.enablePan=!1,w.enableZoom=!1,w.update(),function(e){for(var t=e.getAttribute("position"),a=t.array,n=2,r=0;n<a.length;n+=3,r++)a[n]=0;t.needsUpdate=!0,e.computeVertexNormals()}(S=new m.db(100,100,99,99)),(j=new m.T({color:"#222",side:m.o})).flatShading=!0;var O=new m.Q(S,j);O.position.set(0,0,0),O.castShadow=!0,O.receiveShadow=!0,a.add(O),(N=new m.n(16777215)).position.set(1,1,100),N.shadow={camera:{near:.5,far:300,left:-50,bottom:-50,right:50,top:50},bias:1e-4,mapSize:{x:6144,y:6144}},a.add(N);var k=new m.d(5);y.add(k),(N=new m.n(8840)).position.set(-0,-0,-100),a.add(N);var N=new m.a(6710886);a.add(N);var S=new m.vb(1,32,32),j=new m.R({color:16711680});r=new m.Q(S,j);S=new m.vb(150,32,32);(new m.Ab).crossOrigin="";S=new m.vb(150,32,32),j=new m.R({opacity:0,transparent:!0,alphaTest:.05,side:m.o});var M=new m.Q(S,j);function z(){e.aspect=g.clientWidth/g.clientHeight,e.updateProjectionMatrix(),E.updateProjectionMatrix(),n.setSize(g.clientWidth,g.clientHeight)}return M.rotation.set(Math.PI/2,0,0),a.add(M),function r(){requestAnimationFrame(r),t.update(),w.update(),function(){for(var t=d.getDelta(),r=0;r<window.mergin_mode.mixers.length;++r)window.mergin_mode.mixers[r].update(t);window.mergin_mode.modelLayer.map((function(e){var a=e.mesh.position,n=a.x,r=a.y,o=a.z,i=e.runtimeInfo,c=i.animating,l=i.activeRow,d=window.mergin_mode.vectors.data.filter((function(t){return t.id==e.vectorId}))[0].array[0][l],u=d[0],p=d[1],g=(d[2],d[3]),h=d[4];if(c&&"undefined"!==typeof n&&"undefined"!==typeof r&&"undefined"!==typeof o){var y=window.mergin_mode.plane.dem,v=function(e,t,a,n,r,o){var i=f(e,t,1.2*r,n),c=_(i.Xb,i.Yb,o);return{x:i.Xb,y:i.Yb,z:c}}(Number(n.toFixed(4)),Number(r.toFixed(4)),Number(o.toFixed(4)),g,t,y),E=v.x,w=v.y,O=v.z,k=b(u,p,n,r);if(k===1/0&&(k=0),k<h)e.mesh.position.set(E,w,O);else{var N=window.mergin_mode.vectors.data.filter((function(t){return t.id==e.vectorId}))[0].array[0][l+1];if(N){e.mesh.position.set(N[0],N[1],N[2]),s(e.id,{animating:!0,activeRow:l+1});var S=new m.Gb(0,0,1);e.mesh.rotateOnWorldAxis(S,-(400-d[3]+N[3])/63.6619772367581)}else{var j=window.mergin_mode.vectors.data.filter((function(t){return t.id==e.vectorId}))[0].array[0][0];e.mesh.position.set(j[0],j[1],j[2]),s(e.id,{animating:!1,activeRow:0})}}}})),n.render(a,e),v.render(y,E)}()}(),window.addEventListener("resize",z,!1),document.getElementById("three-map").addEventListener("click",(function(t){var a=document.getElementById("three-map").getBoundingClientRect(),n=a.left,o=a.top;p.x=(t.clientX-n)/g.clientWidth*2-1,p.y=-(t.clientY-o)/g.clientHeight*2+1,u.setFromCamera(p,e);var i=u.intersectObject(O);i.length>0&&(r.position.set(0,0,0),r.lookAt(i[0].face.normal),r.position.copy(i[0].point))}),!1),{camera:e,controls:t,scene:a,renderer:n,pointer:r,partials:{plane:O,pointer:r,sky:M},loaders:i,onWindowResize:z}}L.a.prototype.load2=function(e,t){var a=this,n=e[0],r=new FileReader;r.onload=function(e){2!==e.target.readyState&&0!==e.target.status||a.parse(e.target.result||e.target.responseText,"",t)},r.readAsArrayBuffer(n)},C.a.prototype.load2=function(e,t){var a=this,n=e[0],r=new FileReader;r.onload=function(e){if(2===e.target.readyState||0===e.target.status){var n=a.parse(e.target.result||e.target.responseText);t&&t(n)}},r.readAsArrayBuffer(n)};var A=a(78),R=a(79),D=a.n(R),T=(a(228),a(229),a(205)),I=a(57),F=a(198),P=a(59),B=a(58),G=a(60),W=a(56),U=function(e){function t(e){var a;Object(I.a)(this,t),a=Object(P.a)(this,Object(B.a)(t).call(this,e));e.keys;return a.state={clicked:!1,color:"#000"},a}return Object(G.a)(t,e),Object(F.a)(t,[{key:"render",value:function(){return this.state.clicked?r.a.createElement(W.SketchPicker,null):r.a.createElement("div",{style:{backgroundColof:this.state.color,border:"3px solid whitesmoke",borderRadius:"4px",width:"16px",height:"16px",float:"right"}})}}]),t}(r.a.Component);U.defaultProps={};var q=function(e){return{type:"LOAD_MODEL",model:e,id:Date.now()}},J=function(e){return{type:"SET_PLANE",plane:e,id:Date.now()}},V=function(e){return{type:"CHANGE_SECTION",section:e}},H=function(e){return{type:"SET_LAYERS",layers:e}},X=function(e){return{type:"SET_MODEL_LAYER",layer:e}},Y=function(e,t){console.log(t);var a=e.name.split("-")[0],n=e.name.split("-")[1];"background"===a&&("color"===n?e.scene.background=t?new m.l(e.backgroundColor):null:"image"===n&&(t?e.scene.add(e.sky):e.scene.remove(e.sky)))};var K=Object(d.b)((function(e){return{layers:e.api.layers,scene:e.api.scene,sky:e.api.sky.mesh,backgroundColor:e.api.background.color}}),(function(e){return{changeSection:function(t){return e(V(t))},toggleLayer:Y}}))((function(e){var t=e.keys,a=t,o=Object(n.useState)(e.layers),i=Object(s.a)(o,2),l=i[0],d=i[1];return Object(n.useEffect)((function(){d(e.layers)}),[e.layers]),r.a.createElement("span",{className:"cus-label"},r.a.createElement("span",null,"operations: "),r.a.createElement("span",{style:{color:"blue"},onClick:function(){setTimeout((function(){}),0)}},"Edit"),"\xa0",r.a.createElement("label",{onClick:function(e){return e.stopPropagation()}},r.a.createElement("input",{type:"checkbox"})," checked"),"\xa0",r.a.createElement("span",{style:{color:"#EB0000"},onClick:function(e){window.confirm("sure to delete?")&&e.stopPropagation()}},"Delete")),r.a.createElement("div",{className:"layers-panel",style:{margin:"0 20px"}},r.a.createElement(T.a,{className:"myCls",showLine:!0,checkable:!0,multiple:!1,checkStrictly:!0,selectable:!0,defaultExpandAll:!0,onExpand:function(e){console.log("onExpand",e)},defaultSelectedKeys:[],defaultCheckedKeys:a,onSelect:function(t,a){var n=a.node.key;console.log("selected",t,a),e.changeSection(t.length?n:null)},onCheck:function(t,a){console.log("onCheck",t,a),Y(Object(c.a)({name:a.node.key},e),a.checked)},treeData:l}))})),Q=a(199),Z=a(123),$=a(7),ee=(a(438),a(124));var te=Object(d.b)((function(e){return{models:e.api.models,title:e.api.section.title,scene:e.api.scene,vectors:e.api.vectors.data,layers:e.api.layers}}),(function(e){return{loadModel:function(t){return e(q(t))},changeSection:function(t){return e(V(t))},setModelLayer:function(t){return e(X(t))},setLayers:function(t){return e(H(t))}}}))((function(e){var t=Object(n.useState)({}),a=Object(s.a)(t,2),o=a[0],i=a[1],d=Object(n.useState)(JSON.stringify({})),u=Object(s.a)(d,2),p=u[0],f=u[1],b=Object(n.useState)(JSON.stringify({})),g=Object(s.a)(b,2),h=g[0],y=g[1],v=Object(n.useState)(JSON.stringify({})),E=Object(s.a)(v,2),w=E[0],O=E[1],k=Object(n.useState)({}),N=Object(s.a)(k,2),S=N[0],j=N[1];Object(n.useEffect)((function(){var t={},a={},n={},r={},c={};e.models.data.map((function(e){t[e.id]=p[e.id]||JSON.stringify({x:0,y:0,z:0}),a[e.id]=w[e.id]||JSON.stringify({x:0,y:0,z:0}),n[e.id]=h[e.id]||JSON.stringify({x:1,y:1,z:1}),r[e.id]=o[e.id]||"info",c[e.id]=S[e.id]||0})),f(t),O(a),y(n),i(r),j(c)}),[e.models.data]);var M=function(e,t,a,n){return e(Object(c.a)({},a,Object($.a)({},t,n)))};return r.a.createElement("div",{className:"ModelList container"},r.a.createElement("div",{className:"row"},e.models.data.map((function(t){return r.a.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},r.a.createElement("div",{className:"model-item"},"info"===o[t.id]?r.a.createElement("span",{className:"settings",onClick:function(){return M(i,t.id,o,"settings")}},r.a.createElement("i",{className:"fas fa-cog"})):r.a.createElement("span",{className:"settings",onClick:function(){return M(i,t.id,o,"info")}},r.a.createElement("i",{className:"fas fa-arrow-right"})),"info"===o[t.id]?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"mm-form-block"},r.a.createElement("div",null,"id: ",t.id),r.a.createElement("div",null,"name: ",t.name),r.a.createElement("div",null,"size: ",(t.size/1e3/1e3).toFixed(2)," Mb")),r.a.createElement("button",{className:"mm-btn",onClick:function(){var a=e.vectors.filter((function(e){return e.id==S[t.id]}))[0];if(!a)return!1;if(a.name.includes("anime")){var n,r;if(t.name.includes("glb")||t.name.includes("gltf")){var o=function(e,t,a){var n=new m.c(e),r=m.b.findByName(t,a);if(r){n.clipAction(r).play()}return n}(r=ee.a.clone(t.mesh.scene),t.mesh.animations,"Walk");window.mergin_mode.mixers.push(o)}else r=t.mesh.clone();var i=JSON.parse(w[t.id]);i.x=Number(i.x),i.y=Number(i.y),i.z=Number(i.z);var c=JSON.parse(h[t.id]);c.x=Number(c.x),c.y=Number(c.y),c.z=Number(c.z);var s=new m.Gb(1,0,0),d=new m.Gb(0,1,0),u=new m.Gb(0,0,1);r.rotateOnWorldAxis(s,i.x),r.rotateOnWorldAxis(d,i.y),r.rotateOnWorldAxis(u,-a.array[0][0][3]/63.6619772367581),r.scale.set(c.x,c.y,c.z),(n=r.position).set.apply(n,Object(l.a)(a.array[0][0])),r.castShadow=!0,r.receiveShadow=!0,e.scene.add(r),e.setModelLayer({id:Date.now(),vectorId:a.id,runtimeInfo:{animating:!0,activeRow:0},mesh:r})}else{var p,f,b;(p=t.name.includes("glb")||t.name.includes("gltf")?ee.a.clone(t.mesh.scene):t.mesh.clone()).traverse((function(n){if(n.isMesh){f=n.geometry,b=n.material,p=new m.w(f,b,a.array[0].length,!1,!1,!0);var r=0;for(r=0;r<a.array[0].length;r++){var o,i=new m.ab,c=JSON.parse(w[t.id]);c.x=Number(c.x),c.y=Number(c.y),c.z=Number(c.z);var s=new m.Gb(1,0,0),d=new m.Gb(0,1,0),u=new m.Gb(0,0,1);i.rotateOnWorldAxis(s,c.x),i.rotateOnWorldAxis(d,c.y),i.rotateOnWorldAxis(u,c.z);var g=JSON.parse(h[t.id]);g.x=Number(g.x),g.y=Number(g.y),g.z=Number(g.z),i.scale.set(g.x,g.y,g.z),(o=i.position).set.apply(o,Object(l.a)(a.array[0][r])),i.updateMatrix(),p.setMatrixAt(r++,i.matrix)}e.scene.add(p)}}))}var g=Object(l.a)(e.layers);g[1].children[3].children.push({key:"1-3-".concat(g[1].children[3].children.length),title:t.name+"_"+a.name,checkable:!0,selectable:!1}),e.setLayers(g)}},"Add To Scene")):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Rotation"),r.a.createElement("input",{onChange:function(e){return M(O,t.id,w,e.target.value)},value:w[t.id]}),r.a.createElement("label",null,"Scale"),r.a.createElement("input",{onChange:function(e){return M(y,t.id,h,e.target.value)},value:h[t.id]}),r.a.createElement("label",null,"Position"),r.a.createElement("select",{onChange:function(e){M(j,t.id,S,e.target.value)}},r.a.createElement("option",{value:0,selected:0==S[t.id]},"Select"),e.vectors.map((function(e){return r.a.createElement("option",{value:e.id,selected:S[t.id]==e.id},e.name)}))))))}))))}));var ae=Object(d.b)((function(e){return{models:e.api.models,title:e.api.section.title,scene:e.api.scene,vectors:e.api.vectors.data,layers:e.api.layers}}),(function(e){return{loadModel:function(t){return e(q(t))},changeSection:function(t){return e(V(t))},setModelLayer:function(t){return e(X(t))},setLayers:function(t){return e(H(t))}}}))((function(e){return r.a.createElement("div",{className:"Background container"},r.a.createElement("div",{className:"row"},"Background"))}));var ne=Object(d.b)((function(e){return{models:e.api.models,title:e.api.section.title,scene:e.api.scene,vectors:e.api.vectors.data,plane:e.api.plane.mesh}}),(function(e){return{setPlane:function(t){return e(J({dem:t}))}}}))((function(e){var t=Object(n.useState)(0),a=Object(s.a)(t,2),o=a[0];return a[1],r.a.createElement("div",{className:"ModelList container"},r.a.createElement("h3",null,e.title),r.a.createElement("select",{onChange:function(t){var a=e.vectors.filter((function(e){return e.id==t.target.value}))[0];if(!a)return!1;a=a.array[0];var n,r=e.plane.geometry.attributes.position.array;n=0;for(var o=0;o<1e4;o++)n++,n++,r[n++]=.005*((a[o]||[])[2]||0);e.plane.geometry.attributes.position.needsUpdate=!0;var i=new m.Ab;i.crossOrigin="",i.load("../assets/cropped.png",(function(t){var a=new m.R({map:t});e.plane.material=a,e.plane.material.needsUpdate=!0}),(function(){}),(function(e){console.log(e)}));var c=new m.T({color:"#000",polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1});e.plane.material=c,e.plane.material.needsUpdate=!0,e.setPlane(a)}},r.a.createElement("option",{value:0,selected:0==o},"Select"),e.vectors.map((function(e){return r.a.createElement("option",{value:e.id,selected:o==e.id},e.name)}))))})),re=(a(439),a(200));function oe(e){return r.a.createElement(re.Carousel,{centerMode:!0,centerSlidePercentage:33,emulateTouch:!0},e.slides.map((function(t){return r.a.createElement("div",null,r.a.createElement("img",{src:t.src,className:"mm-image mm-slider-img"}),r.a.createElement("p",{className:"legend mm-btn",onClick:function(a){return function(t,a){t.stopPropagation(),e.onClick(a)}(a,t.src)}},"Use ",t.legend))})))}var ie=Object(d.b)((function(e){return{models:e.api.models,title:e.api.section.title,scene:e.api.scene,sky:e.api.sky.mesh,vectors:e.api.vectors.data,layers:e.api.layers}}),(function(e){return{loadModel:function(t){return e(q(t))},changeSection:function(t){return e(V(t))},setModelLayer:function(t){return e(X(t))},setLayers:function(t){return e(H(t))}}}))((function(e){return r.a.createElement("div",{className:"Images container"},r.a.createElement("div",{className:"row"},r.a.createElement(oe,{onClick:function(t){if("../assets/banned.png"===t)return e.sky.material=new m.R({opacity:0,transparent:!0,alphaTest:.05,side:m.o}),e.sky.material.needsUpdate=!0,!0;var a=new m.Ab;a.crossOrigin="",a.load(t,(function(t){e.sky.material=new m.R({map:t,side:m.e}),e.sky.material.needsUpdate=!0}),(function(){}),(function(e){console.log(e)}))},slides:[{src:"../assets/banned.png",legend:"No Image"},{src:"../assets/sky.jpg",legend:"Sky"},{src:"../assets/night-sky.jpg",legend:"Night Sky"},{src:"../assets/fantasy.jpg",legend:"Fantasy Sky"}]})))}));var ce=Object(d.b)((function(e){return{models:e.api.models,title:e.api.section.title,scene:e.api.scene,plane:e.api.plane.mesh,vectors:e.api.vectors.data,layers:e.api.layers,backgroundColor:e.api.background.color,groundColor:e.api.plane.color}}),(function(e){return{loadModel:function(t){return e(q(t))},changeSection:function(t){return e(V(t))},setModelLayer:function(t){return e(X(t))},setLayers:function(t){return e(H(t))},setBackgroundColor:function(t){return e(function(e){return{type:"SET_BACKGROUND_COLOR",color:e}}(t))},setGroundColor:function(t){return e(function(e){return{type:"SET_GROUND_COLOR",color:e}}(t))}}}))((function(e){var t=Object(n.useState)("background"===e.type?e.backgroundColor:e.groundColor),a=Object(s.a)(t,2),o=a[0],i=a[1];return Object(n.useEffect)((function(){return i("background"===e.type?e.backgroundColor:e.groundColor)}),[e.type]),r.a.createElement("div",{className:"Color container"},r.a.createElement("div",{className:"row"},r.a.createElement(W.ChromePicker,{color:o,onChange:function(t){i(t.hex),"background"===e.type?(e.setBackgroundColor(t.hex),e.scene.background=new m.l(t.hex)):(e.setGroundColor(t.hex),e.plane.material.color=new m.l(t.hex))}})))}));D.a.setAppElement("#root");var le=Object(d.b)((function(e){return{section:e.api.section.active,title:e.api.section.title,layers:e.api.layers,vectors:e.api.vectors,modelLayer:e.api.modelLayer}}),(function(e){return{loadModel:function(t){return e(q(t))},loadVector:function(t){return e(function(e){return{type:"LOAD_VECTOR",vector:e,id:Date.now()}}(t))},changeSection:function(t){return e(V(t))},setScene:function(t){return e(function(e){return{type:"SET_SCENE",scene:e,id:Date.now()}}(t))},setPlane:function(t){return e(J(t))},setSky:function(t){return e(function(e){return{type:"SET_SKY",sky:e,id:Date.now()}}(t))},setLayers:function(t){return e(H(t))},setModelRuntimeInfo:function(t,a){return e(function(e,t){return{type:"SET_MODEL_RUNTIME_INFO",modelId:e,runtimeInfo:Object(c.a)({},t)}}(t,a))}}}))((function(e){var t,a=Object(n.useState)(!1),o=Object(s.a)(a,2),i=o[0],d=o[1],m=Object(n.useState)(!1),u=Object(s.a)(m,2),f=u[0],b=u[1],x=Object(n.useState)([]),C=Object(s.a)(x,2),L=C[0],_=C[1],R=Object(n.useState)({mixers:[],camera:{},controls:{},scene:{},renderer:{},pointer:{},partials:{},loaders:{},onWindowResize:function(){}}),T=Object(s.a)(R,2),I=T[0],F=T[1],P=function(){return b(!f)};return Object(n.useEffect)((function(){I.mixers;var t=I.camera,a=I.controls,n=I.scene,r=I.renderer,o=I.pointer,i=(I.partials,I.loaders),l=(document.getElementById("three-map"),z(t,a,n,r,o,0,i,0,0,e.setModelRuntimeInfo));e.setScene(l.scene),e.setPlane({id:Date.now(),mesh:l.partials.plane}),e.setSky({id:Date.now(),mesh:l.partials.sky}),F(Object(c.a)({},l))}),[]),r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(h.a,{expand:"md",className:"navbar navbar-dark"},r.a.createElement(y.a,{href:"#"},r.a.createElement("div",{className:"logo-container"},r.a.createElement("div",{className:"logo"}))),r.a.createElement(v.a,{onClick:function(){return d(!i)}}),r.a.createElement(E.a,{isOpen:i,navbar:!0},r.a.createElement(w.a,{className:"mr-auto",navbar:!0},r.a.createElement(O.a,{nav:!0,inNavbar:!0},r.a.createElement(k.a,{nav:!0,caret:!0},"File"),r.a.createElement(N.a,{right:!0},r.a.createElement(S.a,{onClick:P},r.a.createElement("span",null,"Import ")),r.a.createElement(S.a,{divider:!0})))),r.a.createElement(j.a,null,r.a.createElement(M.a,{href:"https://github.com/prieston/mergin_mode",target:"_blank"},r.a.createElement("i",{className:"fab fa-github"}),r.a.createElement("span",null,"GitHub")))))),r.a.createElement("main",null,r.a.createElement(A.a,{split:"vertical",minSize:50,maxSize:-50,defaultSize:"40%",onChange:I.onWindowResize},r.a.createElement(K,{keys:["background-color","background-image"]}),r.a.createElement(A.a,{split:"horizontal",minSize:50,maxSize:-50,defaultSize:"60%",onChange:I.onWindowResize},r.a.createElement("div",{id:"three-map"},r.a.createElement("div",{id:"axes-helper"})),null!==e.section&&("models"===(t=e.section)?r.a.createElement(te,null):"background"===t?r.a.createElement(ae,null):"background-color"===t?r.a.createElement(ce,{type:"background"}):"background-image"===t?r.a.createElement(ie,{type:"background"}):"ground-color"===t?r.a.createElement(ce,{type:"ground"}):"ground-image"===t?r.a.createElement(ie,{type:"ground"}):"ground-vertices"===t?r.a.createElement(ne,null):r.a.createElement("span",null))||r.a.createElement("span",null)))),r.a.createElement(D.a,{isOpen:f,onRequestClose:function(){return b(!f)}},r.a.createElement("div",{className:"container form"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement(p,{onChange:function(e){_(Object(l.a)(e.target.files))}}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("button",{className:"btn btn-primary form-control",onClick:function(){if(!L[0])return!1;Array.prototype.slice.call(L).map((function(t){var a=t.name.split(".")[t.name.split(".").length-1];if(["xlsx","xls","ods","csv","xyz"].indexOf(a)>-1){var n=new FileReader,o=[];n.onload=function(a){var n=a.target.result,i=Z.read(n,{type:"binary"}),c=i.SheetNames[0],s=i.Sheets[c],d=Z.utils.sheet_to_csv(s,{header:1});o.push(d.split("\n").map((function(e){return e.split(",").filter((function(e){return e.length>0})).map((function(e){return Number(e)}))})));var m=t.name,u=t.size,p=Object(l.a)(e.layers);if(p[1].children[2].children.push({key:"1-2-".concat(p[1].children[2].children.length),title:m,checkable:!0,selectable:!1,icon:r.a.createElement("span",null)}),e.setLayers(p),m.includes("anime")){for(var f=0;f<o[0].length-1;f++){var b=o[0][f][0],h=o[0][f][1],y=(o[0][f+1]||[])[0]||0,v=(o[0][f+1]||[])[1]||0,E=g(b,h,y,v),w=E.Gab,O=E.Sab;o[0][f][3]=Number(w),o[0][f][4]=Number(O)}e.loadVector({name:m,size:u,array:o})}else e.loadVector({name:m,size:u,array:o})},n.readAsBinaryString(t),b(!f)}else"fbx"==a?function(t){var a=t[0],n=a.name,r=a.size;I.scene;(new I.loaders.FBXLoader).load2(t,(function(t){t.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})),e.loadModel({name:n,size:r,object:t}),b(!f);var a=Object(l.a)(e.layers);a[0].children.push({key:"0-".concat(a[0].children.length),title:n,checkable:!1,selectable:!1}),e.setLayers(a)}))}([t]):"glb"!==a&&"gltf"!==a||function(t){var a=t[0],n=a.name,r=a.size,o=(I.scene,new I.loaders.GLTFLoader),i=new Q.a;o.setDRACOLoader(i),o.load2(t,(function(t){t.scene.traverse((function(e){e.isMesh&&(e.castShadow=!0)})),e.loadModel({name:n,size:r,object:t}),b(!f);var a=Object(l.a)(e.layers);a[0].children.push({key:"0-".concat(a[0].children.length),title:n,checkable:!1,selectable:!1}),e.setLayers(a)}))}([t])})),_([])}},"Load")),r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("button",{className:"btn btn-secondary form-control",onClick:P},"Close"))))))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var se=a(39),de=a(203),me=a(204);window.mergin_mode={modelLayer:[],vectors:[],plane:{},sky:{},mixers:[]};var ue={layers:[{key:"models",title:"Models",checkable:!1,selectable:!0,icon:r.a.createElement("span",{className:"layer-icon"},r.a.createElement("i",{className:"far fa-folder"})),children:[]},{key:"scene",title:"Scene",checkable:!1,selectable:!1,icon:r.a.createElement("span",{className:"layer-icon"},r.a.createElement("i",{className:"far fa-folder"})),children:[{key:"background",title:"Background",checkable:!1,icon:r.a.createElement("span",{className:"layer-icon"},r.a.createElement("i",{className:"far fa-folder"})),children:[{key:"background-color",title:"Color",icon:r.a.createElement("span",{className:"layer-icon"},r.a.createElement("i",{className:"fas fa-palette"}))},{key:"background-image",title:"Image",icon:r.a.createElement("span",{className:"layer-icon"},r.a.createElement("i",{className:"far fa-file-image"}))},{key:"background-video",title:"Video",icon:r.a.createElement("span",{className:"layer-icon"},r.a.createElement("i",{className:"far fa-file-video"}))}]},{key:"ground",title:"Ground",checkable:!1,icon:r.a.createElement("span",{className:"layer-icon"},r.a.createElement("i",{className:"far fa-folder"})),selectable:!1,children:[{key:"ground-color",title:"Color",icon:r.a.createElement("span",{className:"layer-icon"},r.a.createElement("i",{className:"fas fa-palette"}))},{key:"ground-image",title:"Image",icon:r.a.createElement("span",{className:"layer-icon"},r.a.createElement("i",{className:"far fa-file-image"}))},{key:"ground-vertices",title:"Vertices",icon:r.a.createElement("span",{className:"layer-icon"},r.a.createElement("i",{className:"fas fa-mountain"}))}]},{key:"vector-layers",title:"Vector Layers",icon:r.a.createElement("span",{className:"layer-icon"},r.a.createElement("i",{className:"far fa-folder"})),checkable:!1,selectable:!1,children:[]},{key:"model-layers",title:"Model Layers",icon:r.a.createElement("span",{className:"layer-icon"},r.a.createElement("i",{className:"far fa-folder"})),checkable:!1,selectable:!1,children:[]}]}],scene:{},plane:{id:null,mesh:{},dem:[],color:"#222"},sky:{id:null,mesh:{}},background:{color:"#000"},models:{data:[]},vectors:{data:[]},modelLayer:[],section:{active:null,title:null}},pe={models:"Models"},fe=Object(se.c)({api:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_MODEL":return Object.assign({},e,{models:Object.assign({},e.models,{data:[].concat(Object(l.a)(e.models.data),[{id:t.id,mesh:t.model.object,name:t.model.name,size:t.model.size}])})});case"LOAD_VECTOR":var a=Object.assign({},e,{vectors:Object.assign({},e.vectors,{data:[].concat(Object(l.a)(e.vectors.data),[{id:t.id,array:t.vector.array,name:t.vector.name,size:t.vector.size}])})});return window.mergin_mode.vectors=a.vectors,a;case"CHANGE_SECTION":return Object.assign({},e,{section:Object.assign({},e.section,{active:t.section,title:pe[t.section]||null})});case"SET_SCENE":return Object.assign({},e,{scene:t.scene});case"SET_PLANE":var n=Object.assign({},e,{plane:Object(c.a)({},e.plane,{},t.plane)});return window.mergin_mode.plane=n.plane,n;case"SET_SKY":var r=Object.assign({},e,{sky:Object(c.a)({},e.sky,{},t.sky)});return window.mergin_mode.sky=r.sky,r;case"SET_LAYERS":return Object.assign({},e,{layers:t.layers});case"SET_BACKGROUND_COLOR":return Object.assign({},e,{background:{color:t.color}});case"SET_GROUND_COLOR":return Object.assign({},e,{plane:Object(c.a)({},e.plane,{color:t.color})});case"SET_MODEL_LAYER":var o=Object.assign({},e,{modelLayer:[].concat(Object(l.a)(e.modelLayer),[t.layer])});return window.mergin_mode.modelLayer=o.modelLayer,o;case"SET_MODEL_RUNTIME_INFO":var i=Object.assign({},e,{modelLayer:Object(l.a)(e.modelLayer.map((function(e){return e.id==t.modelId&&(e.runtimeInfo=t.runtimeInfo),e})))});return window.mergin_mode.modelLayer=i.modelLayer,i;default:return e}}}),be=document.getElementById("root"),ge=Object(de.createLogger)({}),he=Object(se.d)(fe,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),Object(se.a)(me.a,ge));i.a.render(r.a.createElement(d.a,{store:he},r.a.createElement(le,null)),be),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[208,1,2]]]);
//# sourceMappingURL=main.c494ed6f.chunk.js.map